plot.default(diff(eps_year_xts["1992::2018"])[-1],type='h',axes=F,col=3)
par(new=T)
qtr <- seq(as.Date("1992-04-01"),as.Date("2018-12-31"),by='quarters')
plot.default(qtr,to.quarterly(SP5["1992-04::2018"])[,4],type='l')
abline(v=as.Date("2018-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2015-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2017-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2016-01-01"),col = "gray60",lty=3)
abline(h=2000,col="gray60",lty=3)
abline(v=as.Date("2014-01-01"),col = "gray60",lty=3)


plot.default(diff(PA["1992::2018"])[-1],type='h',axes=F,col=3)
par(new=T)
mnt <- seq(as.Date("1992-02-01"),as.Date("2018-12-31"),by='months')
plot.default(mnt,to.monthly(SP5["1992-02::2018"])[,4],type='l')
abline(v=as.Date("2018-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2015-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2017-01-01"),col = "gray60",lty=3)
abline(v=as.Date("2016-01-01"),col = "gray60",lty=3)
abline(h=2000,col="gray60",lty=3)
abline(v=as.Date("2014-01-01"),col = "gray60",lty=3)

merge(bp.day["2019"],
as.vector(bp.day["2018"][index(seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[index(bp.day["2019"])])][,1]),
as.vector(bp.day["2018"][index(seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[index(bp.day["2019"])])][,2]),
suffixes=c("","h18","l18"))

plot(merge(bp.day["2019"],
as.vector(bp.day["2018"][index(seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[index(bp.day["2019"])])][,1]),
as.vector(bp.day["2018"][index(seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[index(bp.day["2019"])])][,2]),
suffixes=c("","h18","l18")))

> r <- c();for( i in index(bp.day["2019"])){r <- append(r,length(seq(as.Date("2019-01-01"),as.Date(i),by='days')))}
> r
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 42 43 44 45 46 47
> r18 <- c();for( i in index(bp.day["2018"])){r18 <- append(r18,length(seq(as.Date("2018-01-01"),as.Date(i),by='days')))}
> r18
  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28
 [29]  29  30  31  32  33  34  35  36  37  38  39  40  41  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57
 [57]  58  59  60  61  62  64  65  67  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88
 [85]  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 117 118
[113] 119 125 126 127 128 129 130 131 132 133 134 135 136 137 138 140 141 142 143 144 145 146 147 148 151 153 154 155
[141] 156 157 158 159 160 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185
[169] 186 187 189 190 191 192 193 194 195 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
[197] 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243
[225] 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 269 270 271 272 273 276
[253] 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 294 295 296 297 298 299 300 301 302 303 304 305
[281] 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 323 324 325 326 327 328 329 330 331 332 333 334
[309] 335 336 337 338 339 340 341 342 343 344 345 346 347 349 350 351 352 353 354 355 356 359 360 361 362 363 364

> r
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 42 43 44 45 46 47
> index(bp.day["2019"])
 [1] "2019-01-03" "2019-01-04" "2019-01-05" "2019-01-06" "2019-01-07" "2019-01-08" "2019-01-09" "2019-01-10"
 [9] "2019-01-11" "2019-01-12" "2019-01-13" "2019-01-14" "2019-01-15" "2019-01-16" "2019-01-17" "2019-01-18"
[17] "2019-01-19" "2019-01-20" "2019-01-21" "2019-01-22" "2019-01-23" "2019-01-24" "2019-01-25" "2019-01-26"
[25] "2019-01-27" "2019-01-28" "2019-01-29" "2019-01-30" "2019-01-31" "2019-02-01" "2019-02-02" "2019-02-03"
[33] "2019-02-04" "2019-02-05" "2019-02-06" "2019-02-07" "2019-02-08" "2019-02-09" "2019-02-10" "2019-02-11"
[41] "2019-02-12" "2019-02-13" "2019-02-14" "2019-02-15" "2019-02-16"
> r[is.element(r,r18)]
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 43 44 45 46 47
> r18[is.element(r18,r)]
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 43 44 45 46 47
> intersect(r,r18)
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 43 44 45 46 47
> intersect(r18,r)
 [1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 43 44 45 46 47
> bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[intersect(r18,r)]]
            high  low
2019-01-03 130.0 78.0
2019-01-04 136.0 80.0
2019-01-05 129.0 83.0
2019-01-06 127.0 77.5
<skip>
2019-02-15 123.0 76.5
2019-02-16 115.0 76.0
> bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[intersect(r18,r)]]
               high       low
2018-01-03 147.0000 100.00000
2018-01-04 150.0000 104.00000
2018-01-05 131.0000  87.50000
2018-01-06 143.0000 108.00000
>merge(bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[intersect(r18,r)]],as.vector(bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[intersect(r18,r)]][,1]),as.vector(bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[intersect(r18,r)]][,2]),suffixes=c("","h8","l18"))
high  low       h8       l18
2019-01-03 130.0 78.0 147.0000 100.00000
2019-01-04 136.0 80.0 150.0000 104.00000
2019-01-05 129.0 83.0 131.0000  87.50000
2019-01-06 127.0 77.5 143.0000 108.00000
<skip>
2019-02-14 123.5 80.0 127.5000  79.00000
2019-02-15 123.0 76.5 126.0000  75.50000
2019-02-16 115.0 76.0 130.0000  87.00000
>plot(merge(bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[intersect(r18,r)]],as.vector(bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[intersect(r18,r)]][,1]),as.vector(bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[intersect(r18,r)]][,2]),suffixes=c("","h8","l18")),type='p')

>intersect(intersect(index(bp.day["2019"]),seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days'))-17896,intersect(index(bp.day["2018"]),seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days'))-(17896-365))
[1]  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
[39] 41 43 44 45 46 47


bp.day <- apply.daily(bp.bangkok,mean)
d <- intersect(intersect(index(bp.day["2019"]),seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days'))-17896,intersect(index(bp.day["2018"]),seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days'))-(17896-365))

bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[d]]
bp.day[seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[d]]

merge(bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[d]],as.vector(bp.day[,1][seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[d]]),as.vector(bp.day[,2][seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[d]]),suffixes = c("","h18","h18"))


plot(merge(bp.day[seq(as.Date("2019-01-01"),as.Date("2019-12-31"),by='days')[d]],as.vector(bp.day[,1][seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[d]]),as.vector(bp.day[,2][seq(as.Date("2018-01-01"),as.Date("2018-12-31"),by='days')[d]]),suffixes = c("","h18","h18")))

# 飛ぶや飛ばずや、スギ花粉、微妙な感じの月曜日
